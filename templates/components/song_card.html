{% comment %}
Song Card Component
Parameters:
- song: Song object with title, original_song, audio_url, background_image_url
- show_stats: Boolean to show win/loss statistics (optional)
- clickable: Boolean to make card clickable (optional)
- card_id: HTML id for the card (optional)
{% endcomment %}

<div class="card song-card h-100 {% if clickable %}clickable{% endif %}" {% if card_id %}id="{{ card_id }}"{% endif %}>
    {% if song.background_image_url %}
    <div class="position-relative">
        <img src="{{ song.background_image_url }}" class="card-img-top" alt="{{ song.title }}" 
             style="height: 200px; object-fit: cover;">
        {% if show_stats and song.total_picks > 0 %}
        <div class="position-absolute top-0 end-0 m-2">
            <span class="badge bg-success">{{ song.total_wins }}/{{ song.total_picks }}</span>
        </div>
        {% endif %}
    </div>
    {% else %}
    <div class="bg-light d-flex align-items-center justify-content-center" style="height: 200px;">
        <i class="fas fa-music fa-3x text-muted"></i>
        {% if show_stats and song.total_picks > 0 %}
        <div class="position-absolute top-0 end-0 m-2">
            <span class="badge bg-success">{{ song.total_wins }}/{{ song.total_picks }}</span>
        </div>
        {% endif %}
    </div>
    {% endif %}
    
    <div class="card-body d-flex flex-column">
        <h5 class="card-title">{{ song.title }}</h5>
        {% if song.original_song %}
        <p class="card-text text-muted small">Original: {{ song.original_song }}</p>
        {% endif %}
        
        {% if song.audio_url %}
        <div class="mt-auto">
            {% if 'drive.google.com' in song.audio_url %}
            <iframe class="google-drive-audio" src="{{ song.audio_url }}" 
                    width="100%" height="80" frameborder="0" 
                    allow="autoplay; encrypted-media"></iframe>
            {% else %}
            <audio class="audio-player" controls preload="metadata">
                <source src="{{ song.audio_url }}" type="audio/mpeg">
                Your browser does not support the audio element.
            </audio>
            {% endif %}
        </div>
        {% endif %}
    </div>
    
    {% if show_stats %}
    <div class="card-footer text-center">
        <small class="text-muted">
            Win Rate: 
            {% if song.total_picks > 0 %}
                {% widthratio song.total_wins song.total_picks 100 %}%
            {% else %}
                N/A
            {% endif %}
        </small>
    </div>
    {% endif %}
</div>